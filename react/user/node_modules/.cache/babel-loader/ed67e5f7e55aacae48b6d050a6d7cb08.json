{"ast":null,"code":"var _jsxFileName = \"/Users/vishalmahanteshkodagali/Documents/RMIT/Sem 3/Full Stack Development/Assignment/Git_s3895036/loop-web-s3904406/react/user/src/pages/Reviews.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport { getMovieReviews, deleteMovieReviewbyId, getUser, editMovieRatings } from \"../data/repository\";\nimport axios from \"axios\"; // Import Axios\n\nimport '../style.css';\nimport EditReviewForm from \"../components/EditReviewForm\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_HOST = \"http://localhost:4000/api\";\n\nconst ReviewsPage = () => {\n  _s();\n\n  // State to store reviews \n  const [reviews, setReviews] = useState([]); // Logged-in user's ID \n\n  const loggedInUserId = getUser();\n  console.log(loggedInUserId); // State for edit mode and selected review\n\n  const [editMode, setEditMode] = useState(false);\n  const [selectedReview, setSelectedReview] = useState(null); // Function to fetch movie reviews using Axios\n\n  const fetchMovieReviews = async () => {\n    try {\n      const response = await axios.get(`${API_HOST}/reviews`); // Replace with the actual endpoint URL\n\n      setReviews(response.data); // Assuming the data is in response.data\n    } catch (error) {\n      console.error(\"Error fetching movie reviews:\", error);\n    }\n  }; // Fetch movie reviews when the component mounts\n\n\n  useEffect(() => {\n    fetchMovieReviews();\n  }, []); // Function to handle opening edit mode for a review\n\n  const handleEditReview = review => {\n    setSelectedReview(review);\n    setEditMode(true);\n  }; // Function to handle deleting a review\n\n\n  const handleDeleteReview = async review => {\n    await deleteMovieReviewbyId(review);\n    fetchMovieReviews();\n  }; // Function to update a review after editing\n\n\n  const updateReview = async updatedReview => {\n    // Update the review in the state\n    await editMovieRatings(updatedReview);\n    fetchMovieReviews(); // Exit edit mode\n\n    setEditMode(false);\n    setSelectedReview(null);\n  }; // Scroll to top when switching between edit and delete modes\n\n\n  useEffect(() => {\n    window.scrollTo(0, 0);\n  }, [editMode]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"reviews-page\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"All Reviews\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this), reviews.map((review, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"review-item\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: review.movie.movie_name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Rating: \", review.review_rating, \" stars\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: review.review_description\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 11\n      }, this), loggedInUserId === review.username && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"mx-2\",\n          onClick: () => handleEditReview(review),\n          children: \"Edit Review\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => handleDeleteReview(review),\n          children: \"Delete Review\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 13\n      }, this)]\n    }, index, true, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 9\n    }, this)), editMode && /*#__PURE__*/_jsxDEV(EditReviewForm, {\n      review: selectedReview,\n      onCancel: () => setEditMode(false),\n      onUpdate: updateReview\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 5\n  }, this);\n};\n\n_s(ReviewsPage, \"3BAdpr1Fw0/AiRybLLEecSgcSlU=\");\n\n_c = ReviewsPage;\nexport default ReviewsPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"ReviewsPage\");","map":{"version":3,"names":["React","useState","useEffect","getMovieReviews","deleteMovieReviewbyId","getUser","editMovieRatings","axios","EditReviewForm","API_HOST","ReviewsPage","reviews","setReviews","loggedInUserId","console","log","editMode","setEditMode","selectedReview","setSelectedReview","fetchMovieReviews","response","get","data","error","handleEditReview","review","handleDeleteReview","updateReview","updatedReview","window","scrollTo","map","index","movie","movie_name","review_rating","review_description","username"],"sources":["/Users/vishalmahanteshkodagali/Documents/RMIT/Sem 3/Full Stack Development/Assignment/Git_s3895036/loop-web-s3904406/react/user/src/pages/Reviews.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { getMovieReviews, deleteMovieReviewbyId, getUser, editMovieRatings } from \"../data/repository\";\nimport axios from \"axios\"; // Import Axios\nimport '../style.css';\nimport EditReviewForm from \"../components/EditReviewForm\";\nconst API_HOST = \"http://localhost:4000/api\";\n\nconst ReviewsPage = () => {\n\n  // State to store reviews \n  const [reviews, setReviews] = useState([]);\n\n  // Logged-in user's ID \n  const loggedInUserId = getUser();\n  console.log(loggedInUserId);\n\n  // State for edit mode and selected review\n  const [editMode, setEditMode] = useState(false);\n  const [selectedReview, setSelectedReview] = useState(null);\n\n  // Function to fetch movie reviews using Axios\n  const fetchMovieReviews = async () => {\n    try {\n      const response = await axios.get(`${API_HOST}/reviews`)// Replace with the actual endpoint URL\n      setReviews(response.data); // Assuming the data is in response.data\n    } catch (error) {\n      console.error(\"Error fetching movie reviews:\", error);\n    }\n  };\n\n  // Fetch movie reviews when the component mounts\n  useEffect(() => {\n    fetchMovieReviews();\n  }, []);\n\n  // Function to handle opening edit mode for a review\n  const handleEditReview = (review) => {\n    setSelectedReview(review);\n    setEditMode(true);\n  };\n\n  // Function to handle deleting a review\n  const handleDeleteReview = async (review) => {\n\n    await deleteMovieReviewbyId(review);\n    fetchMovieReviews();\n\n  };\n\n  // Function to update a review after editing\n  const updateReview = async (updatedReview) => {\n    // Update the review in the state\n  \n    await editMovieRatings(updatedReview);\n    fetchMovieReviews();\n    \n\n    // Exit edit mode\n    setEditMode(false);\n    setSelectedReview(null);\n  };\n\n  // Scroll to top when switching between edit and delete modes\n  useEffect(() => {\n    window.scrollTo(0, 0);\n  }, [editMode]);\n\n  return (\n    <div className=\"reviews-page\">\n      <h2>All Reviews</h2>\n      {/* Loop through reviews and display review items */}\n      {reviews.map((review, index) => (\n        <div className=\"review-item\" key={index}>\n          <h3>{review.movie.movie_name}</h3>\n          <p>Rating: {review.review_rating} stars</p>\n          <p>{review.review_description}</p>\n          {/* Show edit and delete buttons for the review owner */}\n          {loggedInUserId === review.username && (\n            <div>\n              <button className=\"mx-2\" onClick={() => handleEditReview(review)}>Edit Review</button>\n              <button onClick={() => handleDeleteReview(review)}>Delete Review</button>\n            </div>\n          )}\n        </div>\n      ))}\n      {/* Show edit form in edit mode */}\n      {editMode && (\n        <EditReviewForm\n          review={selectedReview}\n          onCancel={() => setEditMode(false)}\n          onUpdate={updateReview}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default ReviewsPage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}